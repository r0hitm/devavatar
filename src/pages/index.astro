---
import Card from "@/components/Card.astro";
import Hr from "@/components/Hr.astro";
import ProjectCard from "@/components/ProjectCard.astro";
import Prose from "@/components/Prose.astro";
import RootLayout from "@/layouts/RootLayout.astro";
import getPosts from "@/utils/getPosts";
import { ArrowRight, Rss } from "@lucide/astro";
import { getCollection } from "astro:content";

const posts = await getPosts();
const projects = (await getCollection("project")).sort(
    (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);
---

<RootLayout>
    <section>
        <h1 class="my-4 text-3xl font-bold">
            Ahoy!
            <a
                target="_blank"
                href="/rss.xml"
                rel="noopener noreferrer"
                aria-label="rss-link"
                title="RSS Feed"
            >
                <Rss
                    class="stroke-d-accent m-auto inline-block size-5 align-middle"
                />
            </a>
        </h1>

        <Prose>
            <article>
                <p>
                    This is my corner of the internet for all things tech and
                    more! I write mostly about software development, and my
                    project devlogs.
                </p>
                <p>
                    Outside of computers, I'm love Japanese culture, anime,
                    music, gym, and all things adorably cute. I'm always excited
                    to share discoveries from these worlds too!
                </p>
            </article>
        </Prose>
    </section>

    <Hr />

    <section>
        <h2 class="text-2xl font-semibold tracking-wide">Recent Posts</h2>
        <ul>
            {
                posts.map(
                    ({ data, id }, index) =>
                        index < 4 && (
                            <Card
                                href={`/posts/${id}`}
                                postId={id}
                                frontmatter={data}
                            />
                        )
                )
            }
        </ul>
        <div class="my-4 text-center">
            <a
                href="/posts"
                class="group hover:text-d-accent inline-flex items-center justify-center gap-2"
            >
                All Posts
                <ArrowRight
                    class="group-hover:text-d-accent text-d-txt-base size-4"
                />
            </a>
        </div>
    </section>

    <Hr />

    <section>
        <h2 class="text-2xl font-semibold tracking-wide">Recent Project</h2>
        <ul>
            {
                projects.map(
                    (project, index) =>
                        index < 1 && <ProjectCard {...project.data} />
                )
            }
        </ul>
        <div class="my-4 text-center">
            <a
                href="/projects"
                class="group hover:text-d-accent inline-flex items-center justify-center gap-2"
            >
                View More
                <ArrowRight
                    class="group-hover:text-d-accent text-d-txt-base size-4"
                />
            </a>
        </div>
    </section>
</RootLayout>
