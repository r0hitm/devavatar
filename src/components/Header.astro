---
import HeaderLink from "@/components/HeaderLink.astro";
import { SITE } from "@/consts";
import { Menu, Moon, Search, X } from "@lucide/astro";
---

<header class="border-d-accent mx-auto w-full max-w-4xl border-b py-2 sm:py-4">
    <div class="flex items-center justify-between">
        <div class="">
            <a
                href="/"
                class="logo text-xl font-semibold whitespace-nowrap sm:text-2xl"
            >
                {SITE.title}
            </a>
        </div>

        {/* Desktop Navigation & Theme Toggle */}
        <div class="hidden items-center justify-end gap-4 sm:flex">
            <nav>
                <ul class="flex items-center justify-end gap-4">
                    <li>
                        <HeaderLink href="/posts">posts</HeaderLink>
                    </li>
                    <li>
                        <HeaderLink href="/projects">projects</HeaderLink>
                    </li>
                    <li>
                        <HeaderLink href="/tags">tags</HeaderLink>
                    </li>
                    <li>
                        <HeaderLink href="/about">about</HeaderLink>
                    </li>
                    <li>
                        <HeaderLink href="/search" class={"like-button"}>
                            <Search class="size-4" />
                        </HeaderLink>
                    </li>
                </ul>
            </nav>
            <button
                class="hover:text-d-accent inline-block cursor-pointer"
                id="toggle-theme-desktop"
            >
                <Moon class="size-4" />
            </button>
        </div>

        {/* Mobile Menu Button & Theme Toggle */}
        <div class="flex items-center gap-2 sm:hidden">
            <button
                class="hover:text-d-accent inline-block cursor-pointer p-2"
                id="toggle-theme-mobile"
            >
                <Moon class="size-5" />
            </button>
            <button id="mobile-menu-button" class="p-2">
                <Menu class="size-6" id="menu-icon" />
                <X class="hidden size-6" id="close-icon" />
            </button>
        </div>
    </div>

    {/* Mobile Navigation Menu (hidden by default) */}
    <div id="mobile-nav-menu" class="mt-2 hidden flex-col sm:hidden">
        <nav class="w-full">
            <ul
                class="border-d-accent flex flex-col items-start gap-1 border-t pt-2"
            >
                <li>
                    <HeaderLink
                        href="/posts"
                        class="hover:bg-d-accent/10 block w-full rounded-md px-2 py-2"
                        >posts</HeaderLink
                    >
                </li>
                <li>
                    <HeaderLink
                        href="/projects"
                        class="hover:bg-d-accent/10 block w-full rounded-md px-2 py-2"
                        >projects</HeaderLink
                    >
                </li>
                <li>
                    <HeaderLink
                        href="/tags"
                        class="hover:bg-d-accent/10 block w-full rounded-md px-2 py-2"
                        >tags</HeaderLink
                    >
                </li>
                <li>
                    <HeaderLink
                        href="/about"
                        class="hover:bg-d-accent/10 block w-full rounded-md px-2 py-2"
                        >about</HeaderLink
                    >
                </li>
                <li>
                    <HeaderLink
                        href="/search"
                        class={"like-button w-full py-2 px-2 hover:bg-d-accent/10 rounded-md flex items-center gap-2"}
                    >
                        <Search class="size-4" /> Search
                    </HeaderLink>
                </li>
            </ul>
        </nav>
    </div>
</header>

<script>
    const themeTogglerDesktop = document.getElementById("toggle-theme-desktop");
    themeTogglerDesktop?.addEventListener("click", () => {
        // TODO: Implement theme toggling logic or call a global function
        console.error("TODO: Desktop theme toggle placeholder.");
    });

    const themeTogglerMobile = document.getElementById("toggle-theme-mobile");
    themeTogglerMobile?.addEventListener("click", () => {
        // TODO: Implement theme toggling logic or call a global function
        console.error("TODO: Mobile theme toggle placeholder.");
    });

    const mobileMenuButton = document.getElementById("mobile-menu-button");
    const mobileNavMenu = document.getElementById("mobile-nav-menu");
    const menuIcon = document.getElementById("menu-icon");
    const closeIcon = document.getElementById("close-icon");

    mobileMenuButton?.addEventListener("click", () => {
        const isHidden = mobileNavMenu?.classList.contains("hidden");
        if (isHidden) {
            mobileNavMenu?.classList.remove("hidden");
            mobileNavMenu?.classList.add("flex");
            menuIcon?.classList.add("hidden");
            closeIcon?.classList.remove("hidden");
        } else {
            mobileNavMenu?.classList.add("hidden");
            mobileNavMenu?.classList.remove("flex");
            menuIcon?.classList.remove("hidden");
            closeIcon?.classList.add("hidden");
        }
    });
</script>
